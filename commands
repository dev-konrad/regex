import net.sourceforge.plantuml.SourceStringReader;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.UUID;

public class PlantUMLExample {

    public static void main(String[] args) {
        String umlCode = "@startuml\n" +
                "Component A\n" +
                "Component B\n" +
                "Rel(A, B, \" \")\n" +
                "@enduml";

        try {
            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
            SourceStringReader reader = new SourceStringReader(umlCode);
            String desc = reader.generateImage(outputStream);
            outputStream.close();

            // Generate a random identifier for the SVG file name
            String randomIdentifier = UUID.randomUUID().toString().substring(0, 8);

            // Save the SVG to a temporary folder with a unique name
            File tempFolder = new File(System.getProperty("java.io.tmpdir"));
            String svgFileName = "uml_diagram_" + randomIdentifier + ".svg";
            String svgFilePath = tempFolder.getAbsolutePath() + File.separator + svgFileName;
            FileOutputStream fileOutputStream = new FileOutputStream(svgFilePath);
            outputStream.writeTo(fileOutputStream);
            fileOutputStream.close();

            System.out.println("SVG saved to: " + svgFilePath);

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
